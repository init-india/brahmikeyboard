  static-analysis:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Debug AndroidManifest XML Errors
      run: |
        echo "üîç Debugging AndroidManifest XML errors..."
        
        # Show the exact file content with line numbers
        echo "=== F-Droid AndroidManifest.xml ==="
        cat -n android-fdroid/app/src/main/AndroidManifest.xml
        echo "=== End of file ==="
        
        # Try to format and show exact error
        echo "=== XML Validation ==="
        xmllint --noout --valid android-fdroid/app/src/main/AndroidManifest.xml 2>&1 || true
        
        # Check for common issues
        echo "=== Checking for common issues ==="
        
        # Check for unclosed tags
        if ! grep -q '^</manifest>$' android-fdroid/app/src/main/AndroidManifest.xml; then
          echo "‚ùå Missing closing </manifest> tag"
        fi
        
        # Check for proper XML declaration
        if ! head -1 android-fdroid/app/src/main/AndroidManifest.xml | grep -q '<?xml'; then
          echo "‚ùå Missing XML declaration"
        fi
        
        # Check for special characters
        if grep -P -n "[^\x00-\x7F]" android-fdroid/app/src/main/AndroidManifest.xml; then
          echo "‚ùå Found non-ASCII characters"
        fi
        
        echo "‚úÖ Debug complete"
